---
import { getCollection } from 'astro:content';
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import Panel from "../components/Panel.astro";
import Sidebar from "../components/Sidebar.astro";
import ArchiveManager from '../components/vue/ArchiveManager.vue';
import { SITE_DESCRIPTION, SITE_TITLE, SITE_LANGUAGE } from '../consts';

const posts = (await getCollection('blog')).sort(
    (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<!DOCTYPE HTML>
<html lang={SITE_LANGUAGE}>
<head>
    <BaseHead title={"Archive - " + SITE_TITLE} description={SITE_DESCRIPTION} />
</head>
<body class="flex flex-col min-h-screen">
<Header />
<div class="w-full px-4 mt-16 grow">
    <div class="mx-auto max-w-[95%] md:max-w-[80%]">
        <div class="flex flex-col-reverse lg:flex-row gap-8">
            <aside class="lg:w-1/4">
                <Sidebar />
            </aside>

            <main class="lg:w-3/4">
                <Panel>
                    <div class="flex items-center justify-between mb-8 border-b border-zinc-200 dark:border-white/10 pb-4">
                        <h1 class="text-3xl font-bold flex items-center gap-3 text-zinc-800 dark:text-zinc-100">
                            <i class="fa-solid fa-box-archive text-zinc-400"></i>
                            Archive
                        </h1>
                        <span class="text-zinc-500 text-sm">{posts.length} posts total</span>
                    </div>

                    <ArchiveManager client:load posts={posts} />
                </Panel>
            </main>
        </div>
    </div>
</div>
<Footer />
</body>
</html>
