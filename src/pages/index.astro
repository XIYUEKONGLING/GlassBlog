---
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import { SITE_DESCRIPTION, SITE_TITLE, PROJECTS } from '../consts';
import Panel from "../components/Panel.astro";
import Sidebar from "../components/Sidebar.astro";
import ProjectCard from "../components/ProjectCard.astro";
import { getEntry, render } from 'astro:content';
import { SITE_LANGUAGE } from "../consts.ts";

const entry = await getEntry('spec', 'home');

if (!entry) {
	throw new Error('Could not find src/content/spec/home.md');
}

const { Content } = await render(entry);
const hasProjects = PROJECTS && PROJECTS.length > 0;
---

<!DOCTYPE HTML>
<html lang={SITE_LANGUAGE}>
<head>
	<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
</head>
<body class="flex flex-col min-h-screen">
<Header />

<div class="w-full px-4 mt-16 grow">
	<div class="mx-auto max-w-[95%] md:max-w-[80%]">
		<div class="flex flex-col-reverse lg:flex-row gap-8">

			<!-- Left Sidebar -->
			<div class="lg:w-1/4">
				<Sidebar />
			</div>

			<!-- Right Content -->
			<div class="lg:w-3/4 flex flex-col gap-8"> <!-- Added gap-8 and flex-col -->
				<Panel>
					<main class="prose dark:prose-invert max-w-none">
						<h1>{entry.data.title}</h1>
						<Content />
					</main>
				</Panel>

				<!-- Projects Section -->
				{hasProjects && (
					<section class="space-y-6 animate-fade-in-up">
						<div class="flex items-center gap-3 px-4">
							<i class="fa-solid fa-rocket text-zinc-400"></i>
							<h2 class="text-xl font-bold text-zinc-800 dark:text-zinc-100 uppercase tracking-wider">Projects</h2>
							<div class="grow h-px bg-zinc-200 dark:bg-white/10"></div>
						</div>

						<div class:list={[
							"grid gap-6",
							PROJECTS.length > 1 ? "grid-cols-1 md:grid-cols-2" : "grid-cols-1"
						]}>
							{PROJECTS.map((project) => (
								<ProjectCard project={project} />
							))}
						</div>
					</section>
				)}
			</div>
		</div>
	</div>
</div>
<Footer />
</body>
</html>
