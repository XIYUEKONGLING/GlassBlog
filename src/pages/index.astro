---
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import { SITE_DESCRIPTION, SITE_TITLE, PROJECTS } from '../consts';
import Panel from "../components/Panel.astro";
import Sidebar from "../components/Sidebar.astro";
import ProjectCard from "../components/vue/ProjectCard.vue";
import { getEntry, render } from 'astro:content';
import { SITE_LANGUAGE } from "../consts.ts";

const entry = await getEntry('spec', 'home');
if (!entry) throw new Error('Home content not found');

const { Content } = await render(entry);
const hasProjects = PROJECTS && PROJECTS.length > 0;
---

<!DOCTYPE HTML>
<html lang={SITE_LANGUAGE}>
<head>
	<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
</head>
<body class="flex flex-col min-h-screen">
<Header />

<div class="w-full px-4 mt-16 grow">
	<div class="mx-auto max-w-[95%] md:max-w-[80%]">
		<div class="flex flex-col-reverse lg:flex-row gap-8">

			<aside class="lg:w-1/4">
				<Sidebar />
			</aside>

			<main class="lg:w-3/4 flex flex-col gap-8">
				<Panel>
					<article class="prose dark:prose-invert max-w-none">
						<h1>{entry.data.title}</h1>
						<Content />
					</article>
				</Panel>

				{hasProjects && (
					<section class="space-y-6">
						<div class="flex items-center gap-4 px-2">
							<h2 class="text-xs font-bold text-zinc-400 dark:text-zinc-500 uppercase tracking-[0.3em] whitespace-nowrap">
								Projects
							</h2>
							<div class="h-px w-full bg-zinc-200 dark:bg-white/10"></div>
						</div>

						<!-- 
                          Grid Configuration:
                          - Default: 1 column
                          - md (768px): 2 columns (Standard Tablet/Laptop)
                          - xl (1280px): 3 columns (Wide Desktop/PC Fullscreen)
                          - grid-auto-flow-dense: Prevents whitespace when spans are mixed
                        -->
						<div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 grid-auto-flow-dense">
							{PROJECTS.map((project) => (
								<ProjectCard client:load project={project} />
							))}
						</div>
					</section>
				)}

			</main>
		</div>
	</div>
</div>
<Footer />
</body>
</html>
